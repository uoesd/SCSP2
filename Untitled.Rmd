---
title: 'Forensic Modelling of Blood Alcohol Evidence'
author: "Group 13  \nDu Shi, Kunning Zhang, Yixuan Yin\n"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output:
  pdf_document:
    latex_engine: xelatex
    keep_tex: true
    toc: true
    number_sections: true
    toc_depth: 3
csl: ieee.csl
bibliography: references.bib
link-citations: true   
fontsize: 11pt
geometry: margin=1in
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead[L]{\textit{Forensic Modelling of Blood Alcohol Evidence}}
- \fancyhead[R]{\leftmark}
- \fancyfoot[C]{\thepage}
- \usepackage{setspace}
- \onehalfspacing
- \usepackage{titling}
- \pretitle{\begin{center}\LARGE\bfseries}
- \posttitle{\end{center}\vspace{1em}}
- \usepackage{caption}
- \captionsetup[figure]{labelfont=bf,textfont=it}
- \captionsetup[table]{labelfont=bf}
- \usepackage{titlesec}              
- \newcommand{\sectionbreak}{\clearpage}
- |
  \renewcommand{\citeproc}[2]{%
    \hyperref[#1]{\textcolor{blue}{#2}}%
  }
- |
  \let\oldbibitem\bibitem
  \renewcommand{\bibitem}[2][]{%
    \oldbibitem[#1]{#2}%
    \phantomsection\label{#2}%
  } 
---

```{r message=FALSE, warning=FALSE, code=readLines("code.R"), include=FALSE}
# Do not change this code chunk
source("code.R")
set.seed(121212)
```


# Executive Summary

In the UK it is a criminal offence to drive a motor vehicle with a blood or breath alcohol concentration above the prescribed limit. When a person is arrested for driving under the influence of alcohol it is not usually possible to perform an accurate test of the level of alcohol in the blood or breath immediately. Breath tests can be used as an initial screening tool at the scene, but these are not sufficiently accurate for prosecution. Instead, people are taken to a police station or hospital, where the test can be carried out using proper laboratory protocols. As the body clears alcohol from the blood through time this means that if the individual was over the limit, the measured blood alcohol concentration (BAC) will be lower at the time of measurement than it was when the person was driving a motor vehicle. To deal with this situation, If the BAC after time $t$ (hours) is measured as $C_t$ (g/kg), the BAC at time $0$ is estimated as $C_0 = C_t - βt$, where $\beta$ ($g/kg/h$) is BAC elimination rate. 

The key point is how to find a precise $\beta$ to estimate $C_0$. Forensic scientists currently use $2.5\%$ percentile of $\beta$ distribution constructing from samples as the estimated $\beta$ value for every individuals. This method is obviously not rigorous for the courts.

In this report, we introduce a Bayesian Regression Model (BRM) with considering the heterogeneity between individuals, the model gives a posterior distribution of $\hat{\beta}$ by using both samples and prior knowledge. Then we use Markov Chain Monte Carlo (MCMC) to simulate $12000$ $\beta$ draws from posterior distribution and find out the probability of the person's BAC over limit while driving. 

In real world, $\beta$ estimation is quite difficult, it depends on the individuals' liver condition, drinking habits, genetic, diet, etc. As we don't have corresponding data, variation of $\beta$ is mainly explained by gender, but we still find some useful variables like 'weight' and 'drinking time'.

When it is too late to use a blood or breath test and the only information available is eyewitness testimony of the quantity of alcohol consumed. We have to use Widmark's equation:
$$C_t = \frac{A}{Weight \times V_d} - \beta t$$

where $A$ is Amount of Alcohol Consumed (g), $V_d$ is the volume of distribution that need to be found.

Forensic scientists use the same method again to estimate $V_d$ separately with $\beta$. But $V_d$ and $\beta$ are not independent, so the method is also unavailable. To improve it, we build a joint Bayesian regression model, which can simulate them together to solve with the correlation. Then again after simulation, each $C_t$ is calculated by each pair of $\beta$ and $V_d$, so expert witness can still find a probability of $C_t$ exceeding the limit.

Results will be provided in format of table $5$.

# Data Description

$\beta$ true values are converted to positive to convenient calculation. 

It is important to normalized all numerical variables. Centering the covariates can reduce autocorrelation $\rho_k$ of lag $k$ which is defined as:

$$\rho_k = \frac{Cov(\theta^i, \theta^{i+k})}{\theta^2}.$$

'$\rho_k$' is an important indicator to show the performance of a BRM model, it measures how similar the sample at position $i$ is to the sample at position $i+k$. Since MCMC is a random walk process, $\theta_i$ should be similar to $\theta_{i+1}$, less similar to $\theta_{i+2}$, independent with $\theta_{i+k}$ for large $k$. So if $\rho_k$ is large means the chains hardly move, can't converge.

To make it more clear, we will use Effective Sample Size (ESS) to explain: 

$$ n_{\text{eff}} = \frac{n}{1 + 2 \sum_{k=1}^{\infty}\rho_k}.$$ 

'$n_{\text{eff}}$' is large means the MCMC method converge faster (for example $n_{\text{eff}} = 10000$ means the number of independent samples is $10000$ out of $16000$). Larger $n_{\text{eff}}$ in same number of iterations means smaller variance of estimated exoectation since:

$$\mathrm{V}(\hat{E}(\beta)) \approx \frac{\sigma^2}{n_{\text{eff}}}.$$

That's basically why we standardized variables, the statistic ESS will appear in the modeling results.

Also Since $\beta$ is a small value, the coefficients of large value variables are pretty small, near 0, which will make $\beta$ estimation worse, so normalization for variables is necessary.
 
Then we prefer to $\beta$ to $\log(\beta)$ since the original $\beta$ distribution has heavy tail. As shown in figure 1, $\text{log} \beta$ forms a better distribution shape. After simulation we take exponential of the results.


```{r echo=FALSE, fig.cap="log(beta) distribution.", message=FALSE, warning=FALSE}
F1
```


Since $\beta$ is a constant rate, measured when the BAC curve reaches peak and starts to decrease, so variables like AAC and Maximum BAC will not be used, since they are correlated with the value of BAC, not BAC elimination rate.

From the dataset, most data comes from age smaller than $30$, so even though age is a sufficient variable for $\beta$ the model can't really recognize it. Research shows that age doesn't really matter unless the subject has age-related liver disease, but because of moral and ethical, we don't find much research of alcohol test on elderly person with liver disease.

'BAC Peak time' is converted to hours.

# Bayesian regression model

## Advantages and disadvantages of exists method

Although the forensic scientists' method is easy to calculate and conservative enough, but:

* The courts will be forced to make decisions under estimated $\hat{\beta}$ if we only give a single expectation value, since the calculated $C_0$ is either over or under the legal limit. Our job is helping courts make decisions.
* Differences between individuals are ignored, for example weight and sex, which may affect $\beta$.
* $\beta$ value at $2.5\%$ is over conservative and most uncertainties are hiding.

So we don't suggest it.

## Reasons for BRM and advantage

Comparing with fitting linear regression model for $\beta_i$, which can be expressed as:

$$\hat{\beta}_{j} = \hat{\gamma}X_j + \varepsilon_{\beta}, \quad \varepsilon_{\beta} \sim N(0, \sigma_{\beta}^2)$$


and giving a exact value of $\hat{\beta_j}$ under $\varepsilon$ for $j_{th}$ individuals, BRM can model uncertainty of each coefficient $\hat{\gamma}$ and $\varepsilon$. We provide priors and sample likelihoods for all $\hat{\gamma}$ and $\varepsilon$ , BRM will apply bayesian rule to each and output simulation results of each coefficients, not only for $\hat{\beta}$. $\hat{\beta}$s are calculated from simulation results of $\hat{\gamma_j}$, which is:

$$\hat{\beta}_{i,j} = \hat{\gamma}_{i}X_j + \hat{\varepsilon}_{{\beta},i}, \quad \hat{\varepsilon}_{\beta,i} \sim N(0, \hat{\sigma}_{\beta}^2)$$

where $i$ is $i_{th}$ simulation draws.


Since we have log-transformed $\beta$ data points, we will take exponential of $\hat{\beta}_{i,j}$.


## How BRM works

The principle theorem behind BRM is Bayes' Rule:

$$p(\theta \mid \text{data}) = \frac{p(\text{data} \mid \theta) \, p(\theta)}{p(\text{data})}.$$

The $\theta$ in the equation is the $\gamma$s and $\varepsilon$. For most real models, we can't compute this posterior $p(\theta \mid \text{data})$ analytically. Markov Chain Monte Carlo (MCMC) helps us draw samples from it, which we can then summarize. BRM uses Hamiltonian Monte Carlo (One of MCMC), which is better than standard MCMC (like Metropolis-Hastings) since it is faster and cost less.

After setting priors for $\gamma$s and $\varepsilon$, we need specify a family for $\beta$ as the the likelihood of the observed data. In our sample, we have already taken $\log(\beta)$, so it is better to use the most common normal distribution likelihood, it is normal and can express $\beta$ values good without restrict samples' shape.

Also for the MCMC simulation method, we set $4$ chains, each chains $4000$ draws with $1000$ burn-in draws. Since MCMC is a random walk method through parameter space. One chain is a single run of the MCMC algorithm that generates a sequence of samples, so we need more chains to check the convergence and ensure that all chains convergent to same mode. 

For $1000$ burn-in draws, since MCMC starts from an initial value which often far from the true posterior region, so the chains need some steps to walk to the correct trace. As figure 2 shows, it is an example of the MCMC process of coefficient of 'female' when using $4$ chains, $100$ draws. Clearly that if we keep the first $25$ draws, the results will be affected. 

```{r echo=FALSE, fig.cap="MCMC Simulations Traceplot.", message=FALSE, warning=FALSE}
F2
```

## Model Selection

### Key Variables

We remove the intercept and use gender (male and female) to be the two baselines. Since $\beta$ for male and female are in different range.

- Gender: Female's BAC elimination rate is larger than male on average (figure 3), it is explained by liver weight represents a greater fraction of lean body mass in the female gender. [1111111111]

- Drinking time: If the person keep drinking after BAC reaches peak, the measured $\beta$ will be smaller since $\beta$ is measured starting at BAC peak time till the end, there will be fluctuations on the BAC plots. We will use total drinking time as the indicator.

- Weight and Height: Basically higher weight often leads lager size of liver and larger amount of total body water. Height also affect the amount of total body water. [222222222]

```{r Figure, echo=FALSE, fig.cap="Box plot of beta respect to gender.", message=FALSE, warning=FALSE}
F3
```

So the final regression model is:

$$\hat{\beta}_{i,j} = \hat{\gamma}_{1,i}\,\text{female}_j
+ \hat{\gamma}_{2,i}\,\text{male}_j
+ \hat{\gamma}_{3,i}\,\text{weight}_j
+ \hat{\gamma}_{4,i}\,\text{height}_j + \varepsilon_{\beta,i} , \quad \varepsilon_{\beta,i} \sim N(0, \sigma_{\beta}^2).$$

### Priors

Before fitting the Bayesian regression model, appropriate priors need to be specified for all regression coefficients and the residual standard deviation. We use weakly informative priors, which have small effects on the posterior. The selected priors are summarized as follows:

```{r echo=FALSE, message=FALSE, warning=FALSE}
T1
```

We do not expect $\beta$ to have a linear relationship with the variables, so zero-mean normal priors are appropriate. We consider gender to be the baseline factor influencing alcohol elimination rates, so we set relatively wide priors Normal(0, 2) for the sex coefficients, allowing their effects to vary within a reasonable range. For other standardized variables, since their impacts are considered relatively small, we used more shrinkage weakly informative priors Normal(0, 0.5) to prevent unreasonably large effects. The residual standard deviation is given an Exponential($1$) prior, which is a commonly used positive weakly informative prior that can avoid unreasonably high noise.

If future research involves different populations, larger sample sizes, or additional biological information, the prior distributions can be adjusted accordingly to ensure they are applicable to any new datasets.


## Model Results

### Fitting result

After $4000$ iterations in $4$ chains, Table $2$ gives the posterior summary. 'Rhat' compares within-chain variance and between-chain variance, all less than $1.01$ means chains are well‐mixed.


```{r echo=FALSE, message=FALSE, warning=FALSE}
T2
```


Figure 4 shows posterior results for each variables' coefficients, all coefficients show good normal patterns since all chains have converged and warm-up length is enough. Since the $\beta$ is log-transformed, the value of 'b_sexfemale' and 'b_sexmale' is not typical value of $\beta$ like $0.19$ when other coefficients are all near zero. Also $\sigma$ value is estimated  under log-transformed $\beta$.

```{r echo=FALSE, fig.cap="Posterioe density of 4 chains for all coefficients.", message=FALSE, warning=FALSE}
F4
```


Figure 5 shows the trace plots for all variable coefficients, it can be seen that all $4$ chains mix well and all values are picking after convergent.


```{r echo=FALSE, fig.cap="Traceplot of all coefficients and variance sigma.", message=FALSE, warning=FALSE}
F5
```


### PPC Density

Figure 6 is the Posterior Predictive Check (PPC) density plot comparing with true value of $\beta$ (Here we have taken exponential of both true value and predicted value). Notice that predicted posterior distribution matches $\beta$ sample distribution pretty well, which get the mean, spread, skew both right even at right tail.

```{r echo=FALSE, fig.cap="PPC density of 2000 predict results from posterior.", message=FALSE, warning=FALSE}
F6
```


## Model Testing

We take all $12000$ ($16000$ iterations - $4000$ warm-up) number of draws from the posterior distribution.

### LOO-PIT QQ plot

The Leave-One-Out Probability Integral Transform Quantile-Quantile plot (LOO-PIT QQ plot) can check if the predictions calibrated correctly and if the predictive distributions biased, which is defined as:

$$ \mathrm{LOO\text{-}PIT}_i = P(\tilde{y}_i \le y_i |y_{-i}) .$$

Here we still use Monte Carlo method to simulate it, as:

$$
\mathrm{LOO\text{-}PIT}_i
= \frac{1}{S} \sum_{s=1}^{S} 
\mathbf{1}\!\left( \tilde{y}_{i,-i}^{(s)} \le y_i \right)
$$

where $S$ is the number of posterior draws. 

We will use it to check if our posterior is under or over dispersion, the good model's PIT plot should be flat over $Uniform(0,1)$. For our model, the LOO-PIT QQ plot (Figure 7) is flat everywhere except probability near 0.55 and 0.8, which are acceptable by the randomness of MCMC method. A U-shape (points over dot line at two tails) in PIT plots means overestimates variance, it doesn't appear in our plot gives evidence of our choices on variables and likelihood family.

```{r echo=FALSE, fig.cap="LOO-PIT QQ plot", message=FALSE, warning=FALSE}
F7
```

### Coverage rate and Errors

Table 3 shows the coverage rate of $95\%$ and $50\%$ predicted intervals, which means $98$ and $51$ individuals' real $\beta$ value is inside the intervals. The MAE and RMSE are both relatively small.


```{r echo=FALSE, message=FALSE, warning=FALSE}
T3
```

### Cross-Validation

We do two kinds of Cross-Validation: LOO and Kfold (table $4$). The two methods show similar results means the model is stable and the $p$ value is near the number of variables ($5$) shows the model is not over-fitting.

```{r echo=FALSE, message=FALSE, warning=FALSE}
T4
```



# Example

Now we will apply our model on an individual example: A $70$ year old female (weight: $70$kg, height: $160$cm) is arrested after being stopped by the police while driving. She provides a blood sample to the police $2$ hours after her arrest which gives a reading of Ct = $0.15$g/kg. The legal limit is x = $0.47$g/kg. 

Since there is no 'drinking time' data here, we will use a simplified model with only 'sex', 'height', 'weight' variables. We have standardized height and weight by using sample's mean and variance. 

As figure 8 shows, this is the posterior density of $C_0$ calculated by presicted posterior density of $\hat{\beta}$ the dot line is the legal limit $C_0 = 0.47$, it can be seen that most density is larger than $0.47$, so obviously the 70 year old female is over the drink driving limit.

```{r echo=FALSE, fig.cap="Posterior Predictive Distribution of C_0 with limit C_0 = 0.47 (dot line).", message=FALSE, warning=FALSE}
F8
```

To make the result clear, it is better to give Table 5 to the courts and illustrate:

\begin{center}
There is $91.5\%$ probability that the 70 year old female is over the drink driving limit, with both mean, median and mode value over the limit.
\end{center}

The results also show that the original method is not reasonable since $2.5\%$ percentile is over-conservative even in this case.

```{r echo=FALSE, message=FALSE, warning=FALSE}
T5
```

# Widmark's Equation and $V_d$

When it is too late to use a blood or breath test and the only information available is eyewitness testimony of the quantity of alcohol consumed. We have to use Widmark's equation:
$$C_t = \frac{A}{Weight \times V_d} - \beta t.$$
Since there are many versions of Widmark's equation, it can also write as:
$$C_t = \frac{F \times A}{Weight \times \rho} - \beta t $$
where 

$$
\rho = \frac{TBW}{\textit{weight} \times F_{\mathrm{water}}}
$$
is known as Widmark's rho factor.

$F$ is the fraction of the dose that reaches the systemic circulation, $F_{\text{water}}$ is know as the water content of the blood sample, TBW is Total Body Water.

We assume that all different part between two equations are included in $V_d$. The unit of $C_t$ is g/kg in our dataset, the unit of the first term of $C_t$ equation is g/L, but it is not a problem since the density of water is $1$, we just ignore the $1$.

## $V_d$, TBW and $\rho$

All information in this part are from 'Total body water is the preferred method to use in forensic
blood-alcohol calculations rather than ethanol’s volume of distribution'[2].

TBW is calculated by:

$$
\mathrm{TBW}_{\text{Men}}(\mathrm{L}) 
= 2.447 - (0.09516 \times \text{age}) 
    + (0.1074 \times \text{height}) 
    + (0.3362 \times \text{weight})
$$

$$
\mathrm{TBW}_{\text{Women}}(\mathrm{L}) 
= -2.097 
    + (0.1069 \times \text{height}) 
    + (0.2466 \times \text{weight}).
$$


Now subbing the $\rho$ expression in the $C_t$ equation, and comparing with our equation, $V_d$ is actually calculated by:
$$V_d = \frac{\text{TBW}}{\text{weight}} \times \frac{1}{F_{\text{water}}} \times \frac{1}{F} = \eta \times \frac{\text{TBW}}{\text{weight}}$$
and we need to estimate $\eta$ value since TBW is a value that can be determined in our dataset. we will use:

$$\hat{V_d}_{i,j} = \hat{\eta}_{1,i} ( \frac{\text{TBW}}{\text{weight}}_\text{male})_j + \hat{\eta}_{2.i} ( \frac{\text{TBW}}{\text{weight}}_\text{female})_j + \hat{\varepsilon}_{{V_d},{i}}, \quad \hat{\varepsilon}_{{V_d},{i}} \sim N(0, \hat{\sigma}_{V_d}^2)$$
to estimate $\hat{V_d}$ where $i$ is the $i_{th}$ iterations (we will again use BRM, but as a joint model with $\beta$ to deal with the correlation, we will explain it in next part.), $j$ is the $j_{th}$ individuals, $\eta$ is the coefficients that need to be predicted.

## Correlations between $\beta$ and $V_d$

To show that the correlation can't be ignored, figure 9 gives the correlations between true $\beta$ and $V_d$ is $-0.415$, which is relatively big.

```{r echo=FALSE, fig.cap="Correlation plot betweem V_d and Beta", message=FALSE, warning=FALSE}
F9
```



# Joint Bayesian regression model for $\beta$ and $V_d$

## Advantages and disadvantages for exists method for $V_d$

The exists method is easy to calculate. But as we showed before, the correlation between $\beta$ and $V_d$ is relatively large and can't be ignored, especially for the courts since we need the calculated $C_t$ as precise as possible.

## Overview of $V_d$ 

$V_d$ is calculated by true value $\beta$ (with our log-transformed). We will not log-transformed $V_d$ since the density of $V_d$ can't be improved by taking log.

```{r echo=FALSE, fig.cap="Density plot of V_d", message=FALSE, warning=FALSE}
F10
```


## Modeling

The mathematical expression of the joint model can be expressed as:

$$
\hat{\beta}_{i,j} = \hat{\gamma}_{1,i}\,\text{female}_j
+ \hat{\gamma}_{2,i}\,\text{male}_j
+ \hat{\gamma}_{3,i}\,\text{weight}_j
+ \hat{\gamma}_{4,i}\,\text{height}_j + \hat{\varepsilon}_{\beta,i} , \quad \hat{\varepsilon}_{\beta,i} \sim N(0, \hat{\sigma}_{\beta}^2).
$$

and

$$\hat{V_d}_{i,j} = \hat{\eta}_{1,i} ( \frac{\text{TBW}}{\text{weight}}_\text{male})_j + \hat{\eta}_{2.i} ( \frac{\text{TBW}}{\text{weight}}_\text{female})_j +  \hat{\varepsilon}_{{V_d},{i}}, \quad \hat{\varepsilon}_{{V_d},{i}} \sim N(0, \hat{\sigma}_{V_d}^2)$$

where 
$$
\begin{pmatrix}
\hat{\varepsilon}_{\beta,i} \\
\hat{\varepsilon}_{V_d,i}
\end{pmatrix}
\sim
\mathcal{N}\!\left(
\begin{pmatrix} 0 \\ 0 \end{pmatrix},
\begin{pmatrix}
\hat{\sigma}_\beta^2 
& 
\hat{\rho} \, \hat{\sigma}_\beta \hat{\sigma}_{V_d}
\\[6pt]
\hat{\rho} \, \hat{\sigma}_\beta \hat{\sigma}_{V_d}
& 
\hat{\sigma}_{V_d}^2 
\end{pmatrix}
\right).
$$

### Model Selection (priors)

The prior for $\beta$-variable coefficients are unchanged.

The prior for $\eta$ is easy to calculated since $\eta = \frac{1}{F_{\text{water}}} \times \frac{1}{F}$. The Blood water content $F_{\text{water}}$ is easy to determine by desiccation and the mean reported values for men and women are $0.825\%$ w/v and $0.838\%$ w/v respectively. The small sex difference is mainly attributed to lower haematocrit in female blood samples. [33333333]

The fraction of the alcohol dose that reaches the systemic circulation $F$ is typically $0.7$−$0.9$, we use $0.8$. So:

* Prior for $\frac{\text{TBW}}{\text{weight}}_\text{male}$ is $Normal(\frac{1}{0.825} \times \frac{1}{0.8}, 2)  = Normal(1.51, 2)$
* Prior for $\frac{\text{TBW}}{\text{weight}}_\text{male}$ is $Normal(\frac{1}{0.848} \times \frac{1}{0.8}, 2)  = Normal(1.49, 2)$

The mean value of two priors is actually near to the linear regression results of single $V_d$ model ($1.41$ for male and $1.3$ for female).

Priors for others are still weak informative priors. Settings for others are not changed ($4$ chains, $4000$ iterations, $1000$ warm-up).

## Results

Table $6$ belew is the results table, all Rhat and ESS are in good range. The expected estimated correlation $-0.46$ in the model is also near the sample's $V_d$-$\beta$ correlation $-0.415$ (the log-transformation of $\beta$ doesn't affect the correlation.)

```{r echo=FALSE, message=FALSE, warning=FALSE}
T6
```

Figure $11$ shows the joint posterior distribution of $\beta$ and $V_d$. It is a good multivariate gaussian (2d).

```{r echo=FALSE, fig.cap="Joint posterior distribution", message=FALSE, warning=FALSE}  
F11
```


## Testing 

Table $7$ is the LOO and Kfold results, the p values ($11.473$ and $11.111$) means the validation results are good since we have $10$ parameters.

```{r echo=FALSE, message=FALSE, warning=FALSE}
T7
```


Table $8$ shows the MSE of $\beta$, $V_d$ and calculated $C_0$ from joint posterior distribution comparing with true value, and also a MSE for single $\beta$ model to test if the results worse when take in $V_d$. The estimation result for $\beta$ is not worse than before. The calculated $C_0$ coverage rate is very high.

```{r echo=FALSE, message=FALSE, warning=FALSE}
T8
```

# Conclusion

## Limitation

* Based on the variables we have in this sample and small sample size, the model doesn't explain much variation.  

Since the BAC elimination rate $\beta$ really depends on individuals, we can't know what drugs the person is taking or how often the person taking alcohol or health condition of the person, even we know it is still very hard to model all variation, obviously it will cost much. (So in some sense, the original method is an efficient method if they can split the $\beta$ by gender, since it is easy and quick method comparing to our model.)

* The model is sensitive with priors. 

It is better to choose priors by what the courts want, like make the range of priors for $\beta$ narrower (less variance) or give more space to the courts so using a flat prior. In this case we only have $100$ data points, so any choice of prior will affect the posterior a lot. We use non-informative priors, it may cause slower converge. In practice, it is hard to set priors since $\beta$ is quite random.

## Suggestion

When using the model, it is necessary to know when the person is arrested and when the person stop drinking. Although $\beta$ is a constant rate, if the person is arrested before the BAC reaching peak (point at left hand side of the BAC peak point) and measured when the BAC starting decreasing (point at right hand side of the BAC peak point), then if we use $\beta$ value to find BAC value at driving time (arrest time) is not suitable since the calculated BAC value will be higher than true value.

We suggest double blood samples method in practice:

$$
\text{'If a driver is not apprehended sitting behind the wheel, the traffic police in Sweden often submit double blood samples taken about 1 h apart. The mean result at each sampling time can be used to calculate the rate of elimination of alcohol assuming the existence of the post-absorptive declining phase and operation of zero-order kinetics. From a long experience with investigating drunken driving cases, the first blood sample is usually obtained 60 min after an arrest is made depending on location throughout the country where the individual is apprehended and the availability of a physician or nurse to draw blood.}'[4444444444]
$$
# Reference


\appendix

# Model Comparison

We basically focus on choices of priors.

Firstly we will test how sensitive our model is with different priors in table $9$:

* Prior A choose student-t distribution for coefficients of gender variables.
* Prior B use a narrower variance for coefficients of gender variables.


```{r echo=FALSE, message=FALSE, warning=FALSE}
T9
```


As you can see in table $10$, the LOO validation shows the model is sensitive with prior choice. Smaller variance can make the model worse. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
T10
```


Other than this, if we plot the mean posterior $\beta$ value with true $\beta$ value, the results will be more clear. Since the prior variance of coefficients is seted very small, the value of $\beta$ is mainly predicted by gender, which you can find clearly two groups for prior B's model.


```{r echo=FALSE, fig.cap="Mean Posterior Beta VS True Beta for two models", message=FALSE, warning=FALSE}  
F12
```


